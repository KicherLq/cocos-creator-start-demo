{"version":3,"sources":["file:///C:/Users/ctwl/Downloads/cocos-nodejs-io-game-start-demo-master/apps/client/assets/Scripts/Entity/Bullet/BulletManager.ts"],"names":["_decorator","EntityManager","BulletStateMachine","EntityStateEnum","rad2Angle","ccclass","property","BulletManager","type","init","data","fsm","addComponent","state","Idle","render","direction","position","node","setPosition","x","y","side","Math","sqrt","angle","asin","rightAngle"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,a,iBAAAA,a;;AAGAC,MAAAA,kB,iBAAAA,kB;;AACAC,MAAAA,e,iBAAAA,e;;AAEAC,MAAAA,S,iBAAAA,S;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;+BAGjBO,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb;AAAA;AAAA,0CACiD;AAAA;AAAA;AAAA,eACtCC,IADsC;AAAA;;AAG7CC,QAAAA,IAAI,CAACC,IAAD,EAAgB;AAChB,eAAKF,IAAL,GAAYE,IAAI,CAACF,IAAjB;AACA,eAAKG,GAAL,GAAW,KAAKC,YAAL;AAAA;AAAA,uDAAX;AACA,eAAKD,GAAL,CAASF,IAAT,CAAcC,IAAI,CAACF,IAAnB;AAEA,eAAKK,KAAL,GAAa;AAAA;AAAA,kDAAgBC,IAA7B;AACH;;AAEDC,QAAAA,MAAM,CAACL,IAAD,EAAgB;AAClB,gBAAM;AAACM,YAAAA,SAAD;AAAYC,YAAAA;AAAZ,cAAwBP,IAA9B;AACA,eAAKQ,IAAL,CAAUC,WAAV,CAAsBF,QAAQ,CAACG,CAA/B,EAAkCH,QAAQ,CAACI,CAA3C;AAEA,gBAAMC,IAAI,GAAGC,IAAI,CAACC,IAAL,CAAUR,SAAS,CAACI,CAAV,IAAe,CAAf,GAAmBJ,SAAS,CAACK,CAAV,IAAe,CAA5C,CAAb;AACA,gBAAMI,KAAK,GAAG;AAAA;AAAA,sCAAUF,IAAI,CAACG,IAAL,CAAUV,SAAS,CAACK,CAAV,GAAcC,IAAxB,CAAV,CAAd;AACA,gBAAMK,UAAU,GAAG;AAAA;AAAA,sCAAUJ,IAAI,CAACG,IAAL,CAAU,CAACV,SAAS,CAACK,CAAX,GAAeC,IAAzB,CAAV,IAA4C,GAA/D;AACA,eAAKJ,IAAL,CAAUO,KAAV,GAAkBT,SAAS,CAACI,CAAV,GAAc,CAAd,GAAkBK,KAAlB,GAA0BE,UAA5C;AACH;;AAnB4C,O","sourcesContent":["import { _decorator, Component } from 'cc';\r\nimport { EntityManager } from '../../Base/EntityManager';\r\nimport { IBullet } from '../../Common/State';\r\nimport { EntityTypeEnum, InputTypeEnum } from '../../Common/Enum';\r\nimport { BulletStateMachine } from './BulletStateMachine';\r\nimport { EntityStateEnum } from '../../Enum';\r\nimport DataManager from '../../Global/DataManager';\r\nimport { rad2Angle } from '../../Utils';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('BulletManager')\r\nexport class BulletManager extends EntityManager {\r\n    public type: EntityTypeEnum;\r\n\r\n    init(data: IBullet) {\r\n        this.type = data.type;\r\n        this.fsm = this.addComponent(BulletStateMachine);\r\n        this.fsm.init(data.type);\r\n\r\n        this.state = EntityStateEnum.Idle;\r\n    }\r\n\r\n    render(data: IBullet) {\r\n        const {direction, position} = data;\r\n        this.node.setPosition(position.x, position.y);\r\n        \r\n        const side = Math.sqrt(direction.x ** 2 + direction.y ** 2);\r\n        const angle = rad2Angle(Math.asin(direction.y / side));\r\n        const rightAngle = rad2Angle(Math.asin(-direction.y / side)) + 180;\r\n        this.node.angle = direction.x > 0 ? angle : rightAngle;\r\n    }\r\n    \r\n}"]}