{"version":3,"sources":["file:///C:/Users/ctwl/Downloads/cocos-nodejs-io-game-start-demo-master/apps/client/assets/Scripts/Entity/Weapon/WeaponManager.ts"],"names":["_decorator","DataManager","InputTypeEnum","EntityManager","EntityStateEnum","EventEnum","WeaponStateMachine","EventManager","ccclass","property","WeaponManager","__body","__anchor","__point","__id","init","data","id","node","getChildByName","fsm","addComponent","weaponType","state","Idle","Instance","on","shot","handleWeaponShot","onDestroy","off","applyInput","type","Shot","direction","x","y","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;;AACFC,MAAAA,W;;AACkBC,MAAAA,a,iBAAAA,a;;AAEhBC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,e,iBAAAA,e;AAAiBC,MAAAA,S,iBAAAA,S;;AAEjBC,MAAAA,kB,iBAAAA,kB;;AAEFC,MAAAA,Y;;;;;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;+BAGjBU,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb;AAAA;AAAA,0CACiD;AAAA;AAAA;AAAA,eACrCC,MADqC,GACtB,IADsB;AAAA,eAErCC,QAFqC,GAEpB,IAFoB;AAAA,eAGrCC,OAHqC,GAGrB,IAHqB;AAAA,eAIrCC,IAJqC,GAItB,CAJsB;AAAA;;AAM7CC,QAAAA,IAAI,CAACC,IAAD,EAAe;AACf,eAAKF,IAAL,GAAYE,IAAI,CAACC,EAAjB;AACA,eAAKN,MAAL,GAAc,KAAKO,IAAL,CAAUC,cAAV,CAAyB,MAAzB,CAAd;AACA,eAAKP,QAAL,GAAgB,KAAKD,MAAL,CAAYQ,cAAZ,CAA2B,QAA3B,CAAhB;AACA,eAAKN,OAAL,GAAe,KAAKD,QAAL,CAAcO,cAAd,CAA6B,OAA7B,CAAf;AAEA,eAAKC,GAAL,GAAW,KAAKT,MAAL,CAAYU,YAAZ;AAAA;AAAA,uDAAX;AACA,eAAKD,GAAL,CAASL,IAAT,CAAcC,IAAI,CAACM,UAAnB;AAEA,eAAKC,KAAL,GAAa;AAAA;AAAA,kDAAgBC,IAA7B;AACA;AAAA;AAAA,4CAAaC,QAAb,CAAsBC,EAAtB,CAAyB;AAAA;AAAA,sCAAUC,IAAnC,EAAyC,KAAKC,gBAA9C,EAAgE,IAAhE;AACH;;AAESC,QAAAA,SAAS,GAAS;AACxB;AAAA;AAAA,4CAAaJ,QAAb,CAAsBK,GAAtB,CAA0B;AAAA;AAAA,sCAAUH,IAApC,EAA0C,KAAKC,gBAA/C,EAAiE,IAAjE;AACH;;AAEDA,QAAAA,gBAAgB,GAAG;AACf;AAAA;AAAA,0CAAYH,QAAZ,CAAqBM,UAArB,CAAgC;AAC5BC,YAAAA,IAAI,EAAE;AAAA;AAAA,gDAAcC,IADQ;AAE5BhB,YAAAA,EAAE,EAAE,KAAKH,IAFmB;AAG5BoB,YAAAA,SAAS,EAAE;AACPC,cAAAA,CADO;AAEPC,cAAAA;AAFO,aAHiB;AAO5BC,YAAAA;AAP4B,WAAhC;AASH;;AAjC4C,O","sourcesContent":["import { _decorator, Component, input } from 'cc';\r\nimport DataManager from \"../../Global/DataManager\";\r\nimport { EntityTypeEnum, InputTypeEnum } from '../../Common/Enum';\r\nimport { IActor } from '../../Common/State';\r\nimport { EntityManager } from '../../Base/EntityManager';\r\nimport { EntityStateEnum, EventEnum } from '../../Enum';\r\nimport { instantiate } from 'cc';\r\nimport { WeaponStateMachine } from './WeaponStateMachine';\r\nimport { Node } from 'cc';\r\nimport EventManager from '../../Global/EventManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('WeaponManager')\r\nexport class WeaponManager extends EntityManager {\r\n    private __body: Node = null;\r\n    private __anchor: Node = null;\r\n    private __point: Node = null;\r\n    private __id: number = 0;\r\n\r\n    init(data: IActor) {\r\n        this.__id = data.id;\r\n        this.__body = this.node.getChildByName('Body');\r\n        this.__anchor = this.__body.getChildByName('Anchor');\r\n        this.__point = this.__anchor.getChildByName('Point');\r\n        \r\n        this.fsm = this.__body.addComponent(WeaponStateMachine);\r\n        this.fsm.init(data.weaponType);\r\n\r\n        this.state = EntityStateEnum.Idle;\r\n        EventManager.Instance.on(EventEnum.shot, this.handleWeaponShot, this);\r\n    }\r\n\r\n    protected onDestroy(): void {\r\n        EventManager.Instance.off(EventEnum.shot, this.handleWeaponShot, this);\r\n    }\r\n\r\n    handleWeaponShot() {\r\n        DataManager.Instance.applyInput({\r\n            type: InputTypeEnum.Shot,\r\n            id: this.__id,\r\n            direction: {\r\n                x,\r\n                y,\r\n            },\r\n            deltaTime,\r\n        });\r\n    }\r\n    \r\n}"]}