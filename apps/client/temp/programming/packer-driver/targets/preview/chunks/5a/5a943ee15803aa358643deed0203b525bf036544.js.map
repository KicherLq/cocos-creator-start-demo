{"version":3,"sources":["file:///C:/Users/ctwl/Downloads/cocos-nodejs-io-game-start-demo-master/apps/client/assets/Scripts/Entity/Bullet/BulletManager.ts"],"names":["_decorator","EntityManager","InputTypeEnum","BulletStateMachine","EntityStateEnum","DataManager","ccclass","property","BulletManager","type","init","data","fsm","addComponent","state","Idle","tick","deltaTime","Instance","jm","output","length","x","y","applyInput","id","ActorMove","direction","Run","render","position","node","setPosition","setScale"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,a,iBAAAA,a;;AAEgBC,MAAAA,a,iBAAAA,a;;AAChBC,MAAAA,kB,iBAAAA,kB;;AACAC,MAAAA,e,iBAAAA,e;;AACFC,MAAAA,W;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;+BAGjBQ,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb;AAAA;AAAA,0CACiD;AAAA;AAAA;AAAA,eACtCC,IADsC;AAAA;;AAG7CC,QAAAA,IAAI,CAACC,IAAD,EAAgB;AAChB,eAAKF,IAAL,GAAYE,IAAI,CAACF,IAAjB;AACA,eAAKG,GAAL,GAAW,KAAKC,YAAL;AAAA;AAAA,uDAAX;AACA,eAAKD,GAAL,CAASF,IAAT,CAAcC,IAAI,CAACF,IAAnB;AAEA,eAAKK,KAAL,GAAa;AAAA;AAAA,kDAAgBC,IAA7B;AACH;;AAEDC,QAAAA,IAAI,CAACC,SAAD,EAAoB;AACpB,cAAG;AAAA;AAAA,0CAAYC,QAAZ,CAAqBC,EAArB,CAAwBC,MAAxB,CAA+BC,MAA/B,EAAH,EAA4C;AACxC,gBAAM;AAACC,cAAAA,CAAD;AAAIC,cAAAA;AAAJ,gBAAS;AAAA;AAAA,4CAAYL,QAAZ,CAAqBC,EAArB,CAAwBC,MAAvC;AACA;AAAA;AAAA,4CAAYF,QAAZ,CAAqBM,UAArB,CAAgC;AAC5BC,cAAAA,EAAE,EAAE,CADwB;AAE5BhB,cAAAA,IAAI,EAAE;AAAA;AAAA,kDAAciB,SAFQ;AAG5BC,cAAAA,SAAS,EAAE;AACPL,gBAAAA,CADO;AAEPC,gBAAAA;AAFO,eAHiB;AAO5BN,cAAAA;AAP4B,aAAhC;AAUA,iBAAKH,KAAL,GAAa;AAAA;AAAA,oDAAgBc,GAA7B;AACH,WAbD,MAaO;AACH,iBAAKd,KAAL,GAAa;AAAA;AAAA,oDAAgBC,IAA7B;AACH;AACJ;;AAEDc,QAAAA,MAAM,CAAClB,IAAD,EAAgB;AAClB,cAAM;AAACgB,YAAAA,SAAD;AAAYG,YAAAA;AAAZ,cAAwBnB,IAA9B;AACA,eAAKoB,IAAL,CAAUC,WAAV,CAAsBF,QAAQ,CAACR,CAA/B,EAAkCQ,QAAQ,CAACP,CAA3C;;AACA,cAAGI,SAAS,CAACL,CAAV,KAAgB,CAAnB,EAAsB;AAClB,iBAAKS,IAAL,CAAUE,QAAV,CAAmBN,SAAS,CAACL,CAAV,GAAc,CAAd,GAAkB,CAAlB,GAAsB,CAAC,CAA1C,EAA6C,CAA7C;AACH;AAEJ;;AArC4C,O","sourcesContent":["import { _decorator, Component } from 'cc';\r\nimport { EntityManager } from '../../Base/EntityManager';\r\nimport { IBullet } from '../../Common/State';\r\nimport { EntityTypeEnum, InputTypeEnum } from '../../Common/Enum';\r\nimport { BulletStateMachine } from './BulletStateMachine';\r\nimport { EntityStateEnum } from '../../Enum';\r\nimport DataManager from '../../Global/DataManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('BulletManager')\r\nexport class BulletManager extends EntityManager {\r\n    public type: EntityTypeEnum;\r\n\r\n    init(data: IBullet) {\r\n        this.type = data.type;\r\n        this.fsm = this.addComponent(BulletStateMachine);\r\n        this.fsm.init(data.type);\r\n\r\n        this.state = EntityStateEnum.Idle;\r\n    }\r\n\r\n    tick(deltaTime: number) {\r\n        if(DataManager.Instance.jm.output.length()) {\r\n            const {x, y} = DataManager.Instance.jm.output;\r\n            DataManager.Instance.applyInput({\r\n                id: 1,\r\n                type: InputTypeEnum.ActorMove,\r\n                direction: {\r\n                    x,\r\n                    y\r\n                },\r\n                deltaTime,\r\n            });\r\n\r\n            this.state = EntityStateEnum.Run;\r\n        } else {\r\n            this.state = EntityStateEnum.Idle;\r\n        }\r\n    }\r\n\r\n    render(data: IBullet) {\r\n        const {direction, position} = data;\r\n        this.node.setPosition(position.x, position.y);\r\n        if(direction.x !== 0) {\r\n            this.node.setScale(direction.x > 0 ? 1 : -1, 1);\r\n        }\r\n\r\n    }\r\n    \r\n}"]}